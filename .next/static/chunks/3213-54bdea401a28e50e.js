"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3213],{3572:function(t,e,a){a.d(e,{d:function(){return s},z:function(){return d}});var r=a(7821),n=a(8078),o=a(7779),c=a(2555),i=a(5659);let s=(0,c.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=n.forwardRef((t,e)=>{let{className:a,variant:n,size:c,asChild:d=!1,...u}=t,l=d?o.g7:"button";return(0,r.jsx)(l,{className:(0,i.cn)(s({variant:n,size:c,className:a})),ref:e,...u})});d.displayName="Button"},385:function(t,e,a){a.d(e,{KQ:function(){return o},hi:function(){return u}});var r=a(758);let n="http://192.168.0.8:4000/api",o="cart_id";class c extends Error{constructor(t,e,a){super(e),this.status=t,this.errors=a,this.name="ApiError"}}async function i(t){let e=await t.json();if(!t.ok)throw new c(t.status,e.message||"An error occurred",e.errors);return e}function s(){return r.Z.get(o)}function d(){let t=!(arguments.length>0)||void 0===arguments[0]||arguments[0],e={"Content-Type":"application/json"};if(t){let t=s();t&&(e["X-Cart-Id"]=t)}return e}let u={async getProducts(t){let e=new URLSearchParams;return t&&Object.entries(t).forEach(t=>{let[a,r]=t;void 0!==r&&e.append(a,String(r))}),i(await fetch("".concat(n,"/products?").concat(e.toString()),{headers:d(!1)}))},getProduct:async t=>i(await fetch("".concat(n,"/products/").concat(t),{headers:d(!1)})),getFeaturedProducts:async()=>i(await fetch("".concat(n,"/products/featured"),{headers:d(!1)})),getCategories:async()=>i(await fetch("".concat(n,"/categories"),{headers:d(!1)})),getCategoryTree:async()=>i(await fetch("".concat(n,"/categories/tree"),{headers:d(!1)})),async createCart(){var t,e;let a=await fetch("".concat(n,"/cart"),{method:"POST",headers:d(!1)}),c=await i(a);return(null===(t=c.data)||void 0===t?void 0:t.cartId)&&(e=c.data.cartId,r.Z.set(o,e,{expires:365})),c},async getCart(){let t=s();if(!t)return{success:!0,data:{items:[],subtotal:0,itemCount:0}};try{let e=await fetch("".concat(n,"/cart/").concat(t),{headers:d()});return await i(e)}catch(t){if(t instanceof c&&404===t.status)return r.Z.remove(o),{success:!0,data:{items:[],subtotal:0,itemCount:0}};throw t}},async addToCart(t){var e,a;let u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,l=s();l||(l=null===(e=(await this.createCart()).data)||void 0===e?void 0:e.cartId);try{let e=await fetch("".concat(n,"/cart/").concat(l,"/items"),{method:"POST",headers:d(),body:JSON.stringify({productId:t,quantity:u})});return await i(e)}catch(e){if(e instanceof c&&404===e.status)return r.Z.remove(o),l=null===(a=(await this.createCart()).data)||void 0===a?void 0:a.cartId,i(await fetch("".concat(n,"/cart/").concat(l,"/items"),{method:"POST",headers:d(),body:JSON.stringify({productId:t,quantity:u})}));throw e}},async updateCartItem(t,e){let a=s();if(!a)throw new c(400,"No cart found");return i(await fetch("".concat(n,"/cart/").concat(a,"/items/").concat(t),{method:"PUT",headers:d(),body:JSON.stringify({quantity:e})}))},async removeFromCart(t){let e=s();if(!e)throw new c(400,"No cart found");return i(await fetch("".concat(n,"/cart/").concat(e,"/items/").concat(t),{method:"DELETE",headers:d()}))},async clearCart(){let t=s();return t?i(await fetch("".concat(n,"/cart/").concat(t,"/items"),{method:"DELETE",headers:d()})):{success:!0,data:null}},async checkout(t){let e=await fetch("".concat(n,"/orders/checkout"),{method:"POST",headers:d(),body:JSON.stringify(t)}),a=await i(e);return a.success&&r.Z.remove(o),a},trackOrder:async t=>i(await fetch("".concat(n,"/orders/track/").concat(t),{headers:d(!1)})),initiatePayment:async(t,e)=>i(await fetch("".concat(n,"/payments/initiate"),{method:"POST",headers:d(!1),body:JSON.stringify({orderId:t,phoneNumber:e})})),checkPaymentStatus:async t=>i(await fetch("".concat(n,"/payments/").concat(t,"/status"),{headers:d(!1)}))};e.ZP=u},2154:function(t,e,a){a.d(e,{KQ:function(){return r.KQ},hi:function(){return r.ZP}});var r=a(385)},5659:function(t,e,a){a.d(e,{Dx:function(){return s},Jn:function(){return i},T4:function(){return c},cn:function(){return o},ew:function(){return d}});var r=a(6252),n=a(3973);function o(){for(var t=arguments.length,e=Array(t),a=0;a<t;a++)e[a]=arguments[a];return(0,n.m6)((0,r.W)(e))}function c(t){return function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"XAF",a=Math.round(t).toLocaleString("fr-FR"),r={XAF:"FCFA",USD:"$",EUR:"â‚¬",GBP:"\xa3"}[e]||e;return"XAF"===e?"".concat(a," ").concat(r):"".concat(r).concat(a)}("string"==typeof t?parseFloat(t):t,"XAF")}function i(t){var e,a,r;let n=null===(e=t.images)||void 0===e?void 0:e.find(t=>t.isPrimary);return(null==n?void 0:n.url)||(null===(r=t.images)||void 0===r?void 0:null===(a=r[0])||void 0===a?void 0:a.url)||"/placeholder-product.png"}function s(t){switch(t){case"PAID":return"bg-green-100 text-green-800";case"PENDING":return"bg-yellow-100 text-yellow-800";case"FAILED":return"bg-red-100 text-red-800";case"REFUNDED":return"bg-purple-100 text-purple-800";default:return"bg-gray-100 text-gray-800"}}function d(t){return({PENDING:"Order Placed",PICKED_UP:"Picked Up",IN_TRANSIT:"In Transit",DELIVERED:"Delivered",CANCELLED:"Cancelled"})[t]||t}},5847:function(t,e,a){a.d(e,{U6:function(){return l}});var r=a(1434),n=a(4565),o=a(758),c=a(2154);let i="customer_token",s="http://192.168.0.8:4000/api";async function d(t){let e=await t.json();if(!t.ok)throw Error(e.message||e.error||"An error occurred");return e}let u={register:async t=>d(await fetch("".concat(s,"/customers/register"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})),async login(t,e){let a={"Content-Type":"application/json"};return e&&(a["X-Cart-Id"]=e),d(await fetch("".concat(s,"/customers/login"),{method:"POST",headers:a,body:JSON.stringify(t)}))},getProfile:async t=>d(await fetch("".concat(s,"/customers/me"),{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)}})),updateProfile:async(t,e)=>d(await fetch("".concat(s,"/customers/me"),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify(e)})),changePassword:async(t,e,a)=>d(await fetch("".concat(s,"/customers/password"),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({currentPassword:e,newPassword:a})})),addAddress:async(t,e)=>d(await fetch("".concat(s,"/customers/addresses"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify(e)})),updateAddress:async(t,e,a)=>d(await fetch("".concat(s,"/customers/addresses/").concat(e),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify(a)})),deleteAddress:async(t,e)=>d(await fetch("".concat(s,"/customers/addresses/").concat(e),{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)}})),async googleAuth(t,e){let a={"Content-Type":"application/json"};return e&&(a["X-Cart-Id"]=e),d(await fetch("".concat(s,"/customers/google"),{method:"POST",headers:a,body:JSON.stringify(t)}))}},l=(0,r.Ue)()((0,n.tJ)((t,e)=>({customer:null,token:null,isAuthenticated:!1,isLoading:!1,needsPhoneUpdate:!1,register:async e=>{t({isLoading:!0});try{let a=await u.register(e);if(a.success&&a.data){let{token:e,customer:r}=a.data;o.Z.set(i,e,{expires:7}),t({token:e,customer:r,isAuthenticated:!0})}}finally{t({isLoading:!1})}},login:async e=>{t({isLoading:!0});try{let a=o.Z.get(c.KQ),r=await u.login(e,a);if(r.success&&r.data){let{token:e,customer:a}=r.data;o.Z.set(i,e,{expires:7}),t({token:e,customer:a,isAuthenticated:!0,needsPhoneUpdate:!1})}}finally{t({isLoading:!1})}},googleAuth:async e=>{t({isLoading:!0});try{let a=o.Z.get(c.KQ),r=await u.googleAuth(e,a);if(r.success&&r.data){let{token:e,customer:a,needsPhoneUpdate:n}=r.data;o.Z.set(i,e,{expires:7}),t({token:e,customer:a,isAuthenticated:!0,needsPhoneUpdate:n||!1})}}finally{t({isLoading:!1})}},loadAuth:async()=>{let a=o.Z.get(i);if(a&&!e().isAuthenticated)try{let e=await u.getProfile(a);if(e.success&&e.data){let r=e.data,n=!r.phone||r.phone.startsWith("google_");t({token:a,customer:r,isAuthenticated:!0,needsPhoneUpdate:n})}}catch(e){console.error("Failed to load auth:",e),o.Z.remove(i),t({token:null,customer:null,isAuthenticated:!1,needsPhoneUpdate:!1})}},logout:()=>{o.Z.remove(i),t({token:null,customer:null,isAuthenticated:!1,needsPhoneUpdate:!1})},updateProfile:async a=>{let{token:r,customer:n}=e();if(r&&n){t({isLoading:!0});try{let e=await u.updateProfile(r,a);if(e.success&&e.data){let a={...n,...e.data};t({customer:a})}}finally{t({isLoading:!1})}}},changePassword:async(a,r)=>{let{token:n}=e();if(n){t({isLoading:!0});try{await u.changePassword(n,a,r)}finally{t({isLoading:!1})}}},refreshProfile:async()=>{let{token:a}=e();if(a)try{let e=await u.getProfile(a);e.success&&e.data&&t({customer:e.data})}catch(t){console.error("Failed to refresh profile:",t),e().logout()}},addAddress:async a=>{let{token:r,customer:n}=e();if(r&&n){t({isLoading:!0});try{let e=await u.addAddress(r,a);if(e.success&&e.data){let a=n.addresses||[],r={...n,addresses:[...a,e.data]};t({customer:r})}}finally{t({isLoading:!1})}}},updateAddress:async(a,r)=>{let{token:n,customer:o}=e();if(n&&o){t({isLoading:!0});try{let e=await u.updateAddress(n,a,r);if(e.success&&e.data){var c;let n=(null===(c=o.addresses)||void 0===c?void 0:c.map(t=>t.id===a?e.data:t))||[];r.isDefault&&n.forEach(t=>{t.id!==a&&(t.isDefault=!1)});let i={...o,addresses:n};t({customer:i})}}finally{t({isLoading:!1})}}},deleteAddress:async a=>{let{token:r,customer:n}=e();if(r&&n){t({isLoading:!0});try{var o;await u.deleteAddress(r,a);let e=(null===(o=n.addresses)||void 0===o?void 0:o.filter(t=>t.id!==a))||[],c={...n,addresses:e};t({customer:c})}finally{t({isLoading:!1})}}}}),{name:"customer-storage",partialize:t=>({token:t.token,customer:t.customer,isAuthenticated:t.isAuthenticated})}))}}]);