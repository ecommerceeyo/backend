(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2837],{3718:function(e,t,s){Promise.resolve().then(s.bind(s,9726))},9726:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return N}});var r=s(7821),i=s(8078),a=s(6665),c=s(4601),l=s(5002),n=s(346),o=s(3572),d=s(9827),u=s(8407),p=s(5445),h=s(5537),m=s(3481),x=s(8770),g=s(7251),j=s(7944),f=s(8153),y=s(7384),v=s(3350);function N(){let e=(0,a.useRouter)(),{supplierAdmin:t}=(0,v.A)(),s=(null==t?void 0:t.role)==="OWNER"||(null==t?void 0:t.role)==="MANAGER",[N,P]=(0,i.useState)(!1),[k,S]=(0,i.useState)([]),[A,b]=(0,i.useState)([]),[w,C]=(0,i.useState)([]),[O,I]=(0,i.useState)([]),[F,T]=(0,i.useState)({name:"",description:"",price:"",compareAtPrice:"",stock:"",sku:"",categoryId:"",isActive:!0,isPreorder:!1,preorderNote:""}),[E,L]=(0,i.useState)({});if((0,i.useEffect)(()=>{(async()=>{try{let e=await y.R.getCategories();e.success&&e.data&&S(e.data)}catch(e){console.error("Failed to fetch categories:",e)}})()},[]),!s)return(0,r.jsx)("div",{className:"flex h-[50vh] items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold",children:"Access Denied"}),(0,r.jsx)("p",{className:"mt-2 text-muted-foreground",children:"You don't have permission to create products. Contact your supplier owner or manager."}),(0,r.jsx)(n.default,{href:"/supplier/products",children:(0,r.jsx)(o.z,{variant:"outline",className:"mt-4",children:"Back to Products"})})]})});let _=()=>{let e={};return F.name.trim()||(e.name="Name is required"),(!F.price||0>=parseFloat(F.price))&&(e.price="Valid price is required"),(!F.stock||0>parseInt(F.stock))&&(e.stock="Valid stock quantity is required"),F.categoryId||(e.categoryId="Category is required"),L(e),0===Object.keys(e).length},Z=async t=>{if(t.preventDefault(),_()){P(!0);try{let t={name:F.name,description:F.description,price:parseFloat(F.price),compareAtPrice:F.compareAtPrice?parseFloat(F.compareAtPrice):void 0,stock:parseInt(F.stock),sku:F.sku||void 0,categoryId:F.categoryId,isActive:F.isActive,isPreorder:F.isPreorder,preorderNote:F.preorderNote||void 0,images:A.map(e=>({url:e.url,publicId:e.publicId,isPrimary:e.isPrimary})),specifications:w.filter(e=>""!==e.value.trim()).map(e=>({key:e.key,value:e.value,group:e.group})),deliveryZones:O.filter(e=>""!==e.zoneName.trim()).map(e=>({zoneName:e.zoneName,zoneType:e.zoneType,region:e.region,minDays:e.minDays,maxDays:e.maxDays,deliveryFee:e.deliveryFee,available:e.available,notes:e.notes}))},s=await y.R.createProduct(t);s.success?e.push("/supplier/products"):L({submit:s.error||"Failed to create product"})}catch(e){L({submit:e.message||"An error occurred. Please try again."})}finally{P(!1)}}};return(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsxs)(n.default,{href:"/supplier/products",className:"mb-6 inline-flex items-center text-sm text-muted-foreground hover:text-foreground",children:[(0,r.jsx)(c.Z,{className:"mr-2 h-4 w-4"}),"Back to Products"]}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold",children:"Add New Product"}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"Create a new product for your store"})]}),(0,r.jsxs)("form",{onSubmit:Z,className:"space-y-6",children:[E.submit&&(0,r.jsx)("div",{className:"rounded-lg bg-destructive/10 p-4 text-sm text-destructive",children:E.submit}),(0,r.jsxs)("div",{className:"grid gap-6 lg:grid-cols-3",children:[(0,r.jsxs)("div",{className:"space-y-6 lg:col-span-2",children:[(0,r.jsxs)(h.Zb,{children:[(0,r.jsx)(h.Ol,{children:(0,r.jsx)(h.ll,{children:"Product Information"})}),(0,r.jsxs)(h.aY,{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)(u._,{htmlFor:"name",children:["Name ",(0,r.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,r.jsx)(d.I,{id:"name",value:F.name,onChange:e=>T({...F,name:e.target.value}),placeholder:"Product name"}),E.name&&(0,r.jsx)("p",{className:"text-sm text-destructive",children:E.name})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(u._,{htmlFor:"description",children:"Description"}),(0,r.jsx)(p.g,{id:"description",value:F.description,onChange:e=>T({...F,description:e.target.value}),placeholder:"Product description",rows:5})]})]})]}),(0,r.jsxs)(h.Zb,{children:[(0,r.jsx)(h.Ol,{children:(0,r.jsx)(h.ll,{children:"Media"})}),(0,r.jsx)(h.aY,{children:(0,r.jsx)(g.U,{images:A,onImagesChange:b,maxImages:6})})]}),(0,r.jsxs)(h.Zb,{children:[(0,r.jsx)(h.Ol,{children:(0,r.jsx)(h.ll,{children:"Pricing"})}),(0,r.jsx)(h.aY,{className:"space-y-4",children:(0,r.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)(u._,{htmlFor:"price",children:["Price (FCFA) ",(0,r.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,r.jsx)(d.I,{id:"price",type:"number",step:"1",min:"0",value:F.price,onChange:e=>T({...F,price:e.target.value}),placeholder:"0"}),E.price&&(0,r.jsx)("p",{className:"text-sm text-destructive",children:E.price})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(u._,{htmlFor:"compareAtPrice",children:"Compare at Price"}),(0,r.jsx)(d.I,{id:"compareAtPrice",type:"number",step:"1",min:"0",value:F.compareAtPrice,onChange:e=>T({...F,compareAtPrice:e.target.value}),placeholder:"0"})]})]})})]}),(0,r.jsxs)(h.Zb,{children:[(0,r.jsx)(h.Ol,{children:(0,r.jsx)(h.ll,{children:"Inventory"})}),(0,r.jsx)(h.aY,{className:"space-y-4",children:(0,r.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)(u._,{htmlFor:"stock",children:["Stock ",(0,r.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,r.jsx)(d.I,{id:"stock",type:"number",min:"0",value:F.stock,onChange:e=>T({...F,stock:e.target.value}),placeholder:"0"}),E.stock&&(0,r.jsx)("p",{className:"text-sm text-destructive",children:E.stock})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(u._,{htmlFor:"sku",children:"SKU"}),(0,r.jsx)(d.I,{id:"sku",value:F.sku,onChange:e=>T({...F,sku:e.target.value}),placeholder:"SKU-001"})]})]})})]}),(0,r.jsxs)(h.Zb,{children:[(0,r.jsx)(h.Ol,{children:(0,r.jsx)(h.ll,{children:"Specifications"})}),(0,r.jsx)(h.aY,{children:(0,r.jsx)(j.l,{specifications:w,onChange:C})})]}),(0,r.jsxs)(h.Zb,{children:[(0,r.jsx)(h.Ol,{children:(0,r.jsx)(h.ll,{children:"Delivery Zones & Periods"})}),(0,r.jsx)(h.aY,{children:(0,r.jsx)(f.J,{deliveryZones:O,onChange:I})})]})]}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)(h.Zb,{children:[(0,r.jsx)(h.Ol,{children:(0,r.jsx)(h.ll,{children:"Organization"})}),(0,r.jsx)(h.aY,{className:"space-y-4",children:(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)(u._,{children:["Category ",(0,r.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,r.jsxs)(m.Ph,{value:F.categoryId,onValueChange:e=>T({...F,categoryId:e}),children:[(0,r.jsx)(m.i4,{children:(0,r.jsx)(m.ki,{placeholder:"Select category"})}),(0,r.jsx)(m.Bw,{children:k.map(e=>(0,r.jsx)(m.Ql,{value:e.id,children:e.name},e.id))})]}),E.categoryId&&(0,r.jsx)("p",{className:"text-sm text-destructive",children:E.categoryId})]})})]}),(0,r.jsxs)(h.Zb,{children:[(0,r.jsx)(h.Ol,{children:(0,r.jsx)(h.ll,{children:"Status"})}),(0,r.jsxs)(h.aY,{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)(u._,{htmlFor:"isActive",children:"Active"}),(0,r.jsx)(x.r,{id:"isActive",checked:F.isActive,onCheckedChange:e=>T({...F,isActive:e})})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)(u._,{htmlFor:"isPreorder",children:"Pre-order"}),(0,r.jsx)(x.r,{id:"isPreorder",checked:F.isPreorder,onCheckedChange:e=>T({...F,isPreorder:e})})]}),F.isPreorder&&(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(u._,{htmlFor:"preorderNote",children:"Pre-order Note"}),(0,r.jsx)(d.I,{id:"preorderNote",value:F.preorderNote,onChange:e=>T({...F,preorderNote:e.target.value}),placeholder:"e.g., Ships in 2-3 weeks"}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"Shown to customers when they order this product"})]})]})]})]})]}),(0,r.jsxs)("div",{className:"flex justify-end gap-4",children:[(0,r.jsx)(n.default,{href:"/supplier/products",children:(0,r.jsx)(o.z,{type:"button",variant:"outline",children:"Cancel"})}),(0,r.jsx)(o.z,{type:"submit",disabled:N,children:N?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(l.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Creating..."]}):"Create Product"})]})]})]})}},7384:function(e,t,s){"use strict";s.d(t,{R:function(){return c}});let r="http://192.168.0.8:4000/api";function i(){let e=localStorage.getItem("supplier-auth");if(!e)return{};try{let{state:t}=JSON.parse(e);if(null==t?void 0:t.token)return{Authorization:"Bearer ".concat(t.token)}}catch(e){}return{}}async function a(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=await fetch(e,{...t,headers:{"Content-Type":"application/json",...i(),...t.headers}}),r=await s.json();if(!s.ok)throw Error(r.error||"Request failed");return r}let c={getDashboard:()=>a("".concat(r,"/supplier-portal/dashboard")),getProfile:()=>a("".concat(r,"/supplier-portal/profile")),updateProfile:e=>a("".concat(r,"/supplier-portal/profile"),{method:"PUT",body:JSON.stringify(e)}),getProducts:e=>{let t=new URLSearchParams;return(null==e?void 0:e.page)&&t.set("page",e.page.toString()),(null==e?void 0:e.limit)&&t.set("limit",e.limit.toString()),(null==e?void 0:e.search)&&t.set("search",e.search),(null==e?void 0:e.active)!==void 0&&t.set("active",e.active.toString()),a("".concat(r,"/supplier-portal/products?").concat(t))},getProduct:e=>a("".concat(r,"/supplier-portal/products/").concat(e)),createProduct:e=>a("".concat(r,"/supplier-portal/products"),{method:"POST",body:JSON.stringify(e)}),updateProduct:(e,t)=>a("".concat(r,"/supplier-portal/products/").concat(e),{method:"PUT",body:JSON.stringify(t)}),deleteProduct:e=>a("".concat(r,"/supplier-portal/products/").concat(e),{method:"DELETE"}),getOrders:e=>{let t=new URLSearchParams;return(null==e?void 0:e.page)&&t.set("page",e.page.toString()),(null==e?void 0:e.limit)&&t.set("limit",e.limit.toString()),(null==e?void 0:e.status)&&t.set("status",e.status),(null==e?void 0:e.search)&&t.set("search",e.search),a("".concat(r,"/supplier-portal/orders?").concat(t))},getOrderItem:e=>a("".concat(r,"/supplier-portal/orders/").concat(e)),updateFulfillment:(e,t)=>a("".concat(r,"/supplier-portal/orders/").concat(e,"/fulfillment"),{method:"PATCH",body:JSON.stringify(t)}),getPayouts:e=>{let t=new URLSearchParams;return(null==e?void 0:e.page)&&t.set("page",e.page.toString()),(null==e?void 0:e.limit)&&t.set("limit",e.limit.toString()),a("".concat(r,"/supplier-portal/payouts?").concat(t))},getStaff:()=>a("".concat(r,"/supplier-auth/staff")),createStaff:e=>a("".concat(r,"/supplier-auth/staff"),{method:"POST",body:JSON.stringify(e)}),updateStaffStatus:(e,t)=>a("".concat(r,"/supplier-auth/staff/").concat(e,"/status"),{method:"PATCH",body:JSON.stringify({active:t})}),deleteStaff:e=>a("".concat(r,"/supplier-auth/staff/").concat(e),{method:"DELETE"}),changePassword:(e,t)=>a("".concat(r,"/supplier-auth/change-password"),{method:"POST",body:JSON.stringify({currentPassword:e,newPassword:t})}),getCategories:()=>fetch("".concat(r,"/categories")).then(e=>e.json()),uploadImage:async e=>{let t=new FormData;return t.append("image",e),(await fetch("".concat(r,"/admin/upload/image"),{method:"POST",headers:i(),body:t})).json()}}},3350:function(e,t,s){"use strict";s.d(t,{A:function(){return c}});var r=s(1434),i=s(4565);let a="http://192.168.0.8:4000/api",c=(0,r.Ue)()((0,i.tJ)((e,t)=>({token:null,supplierAdmin:null,supplier:null,isAuthenticated:!1,isLoading:!1,login:async(t,s)=>{e({isLoading:!0});try{let r=await fetch("".concat(a,"/supplier-auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t,password:s})}),i=await r.json();if(!r.ok)throw Error(i.error||"Login failed");e({token:i.data.token,supplierAdmin:i.data.supplierAdmin,supplier:i.data.supplier,isAuthenticated:!0,isLoading:!1})}catch(t){throw e({isLoading:!1}),t}},register:async t=>{e({isLoading:!0});try{let s=await fetch("".concat(a,"/supplier-auth/register"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),r=await s.json();if(!s.ok)throw Error(r.error||"Registration failed");return e({isLoading:!1}),r}catch(t){throw e({isLoading:!1}),t}},logout:()=>{e({token:null,supplierAdmin:null,supplier:null,isAuthenticated:!1})},setAuth:(t,s,r)=>{e({token:t,supplierAdmin:s,supplier:r,isAuthenticated:!0})},checkAuth:async()=>{let{token:s}=t();if(!s){e({isAuthenticated:!1});return}e({isLoading:!0});try{let t=await fetch("".concat(a,"/supplier-auth/me"),{headers:{Authorization:"Bearer ".concat(s)}});if(!t.ok)throw Error("Session expired");let r=await t.json();e({supplierAdmin:r.data.supplierAdmin,supplier:r.data.supplier,isAuthenticated:!0,isLoading:!1})}catch(t){e({token:null,supplierAdmin:null,supplier:null,isAuthenticated:!1,isLoading:!1})}}}),{name:"supplier-auth",partialize:e=>({token:e.token,supplierAdmin:e.supplierAdmin,supplier:e.supplier,isAuthenticated:e.isAuthenticated})}))}},function(e){e.O(0,[8616,7886,346,9216,807,3444,8088,3929,9632,7115,9069,1744],function(){return e(e.s=3718)}),_N_E=e.O()}]);