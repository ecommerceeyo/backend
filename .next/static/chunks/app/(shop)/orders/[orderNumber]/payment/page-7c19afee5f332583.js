(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6175],{732:function(e,t,r){Promise.resolve().then(r.bind(r,7742))},7742:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return y}});var n=r(7821),a=r(8078),s=r(6665),c=r(9829),i=r(5002),o=r(979),u=r(316),d=r(499),l=r(3572),f=r(5537),m=r(9827),h=r(8407),p=r(385);function y(){let e=(0,s.useParams)(),t=(0,s.useRouter)(),r=e.orderNumber,[y,g]=(0,a.useState)("pending"),[x,v]=(0,a.useState)(""),[b,w]=(0,a.useState)(!1),[N,j]=(0,a.useState)(""),[P,C]=(0,a.useState)(0);(0,a.useEffect)(()=>{(async()=>{try{let e=await p.hi.trackOrder(r);e.success&&e.data&&(C(e.data.total),"PAID"===e.data.paymentStatus&&t.push("/orders/".concat(r,"/confirmation")))}catch(e){console.error("Failed to fetch order:",e)}})()},[r,t]);let k=async e=>{if(e.preventDefault(),j(""),!x||x.length<10){j("Please enter a valid phone number");return}w(!0),g("processing");try{let e=await p.hi.initiatePayment(r,x);e.success?S():(g("failed"),j(e.error||"Payment initiation failed"))}catch(e){g("failed"),j("Failed to initiate payment. Please try again.")}finally{w(!1)}},S=async()=>{let e=0,n=async()=>{try{let a=await p.hi.checkPaymentStatus(r);if(a.success&&a.data){if("PAID"===a.data.status){g("success"),setTimeout(()=>{t.push("/orders/".concat(r,"/confirmation"))},2e3);return}if("FAILED"===a.data.status){g("failed"),j("Payment was declined. Please try again.");return}}++e<30?setTimeout(n,5e3):(g("failed"),j("Payment timeout. Please check your phone for the prompt."))}catch(e){g("failed"),j("Failed to verify payment status.")}};n()};return(0,n.jsx)("div",{className:"container mx-auto max-w-md px-4 py-8",children:(0,n.jsxs)(f.Zb,{children:[(0,n.jsxs)(f.Ol,{className:"text-center",children:[(0,n.jsx)(f.ll,{children:"Mobile Money Payment"}),(0,n.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Order: ",r]})]}),(0,n.jsxs)(f.aY,{children:["pending"===y&&(0,n.jsxs)("form",{onSubmit:k,className:"space-y-4",children:[(0,n.jsxs)("div",{className:"rounded-lg bg-muted p-4 text-center",children:[(0,n.jsxs)("p",{className:"text-2xl font-bold",children:["GHS ",P.toLocaleString()]}),(0,n.jsx)("p",{className:"text-sm text-muted-foreground",children:"Amount to pay"})]}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)(h._,{htmlFor:"phone",children:"Mobile Money Number"}),(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)(c.Z,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),(0,n.jsx)(m.I,{id:"phone",type:"tel",placeholder:"024 XXX XXXX",value:x,onChange:e=>v(e.target.value),className:"pl-10"})]})]}),N&&(0,n.jsx)("div",{className:"rounded-lg bg-destructive/10 p-3 text-sm text-destructive",children:N}),(0,n.jsx)(l.z,{type:"submit",className:"w-full",disabled:b,children:b?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Initiating..."]}):"Pay Now"}),(0,n.jsx)("p",{className:"text-center text-xs text-muted-foreground",children:"You will receive a prompt on your phone to approve the payment"})]}),"processing"===y&&(0,n.jsxs)("div",{className:"space-y-4 text-center",children:[(0,n.jsx)(o.Z,{className:"mx-auto h-16 w-16 animate-pulse text-yellow-500"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"text-lg font-semibold",children:"Waiting for Payment Approval"}),(0,n.jsx)("p",{className:"text-sm text-muted-foreground",children:"Please check your phone and approve the payment prompt"})]}),(0,n.jsx)("div",{className:"rounded-lg bg-muted p-4",children:(0,n.jsxs)("p",{className:"text-sm",children:["A payment request has been sent to"," ",(0,n.jsx)("strong",{children:x})]})})]}),"success"===y&&(0,n.jsxs)("div",{className:"space-y-4 text-center",children:[(0,n.jsx)(u.Z,{className:"mx-auto h-16 w-16 text-green-500"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"text-lg font-semibold",children:"Payment Successful!"}),(0,n.jsx)("p",{className:"text-sm text-muted-foreground",children:"Redirecting to confirmation page..."})]})]}),"failed"===y&&(0,n.jsxs)("div",{className:"space-y-4 text-center",children:[(0,n.jsx)(d.Z,{className:"mx-auto h-16 w-16 text-destructive"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"text-lg font-semibold",children:"Payment Failed"}),(0,n.jsx)("p",{className:"text-sm text-muted-foreground",children:N})]}),(0,n.jsx)(l.z,{onClick:()=>{g("pending"),j("")},className:"w-full",children:"Try Again"})]})]})]})})}},3572:function(e,t,r){"use strict";r.d(t,{d:function(){return o},z:function(){return u}});var n=r(7821),a=r(8078),s=r(7779),c=r(2555),i=r(5659);let o=(0,c.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),u=a.forwardRef((e,t)=>{let{className:r,variant:a,size:c,asChild:u=!1,...d}=e,l=u?s.g7:"button";return(0,n.jsx)(l,{className:(0,i.cn)(o({variant:a,size:c,className:r})),ref:t,...d})});u.displayName="Button"},5537:function(e,t,r){"use strict";r.d(t,{Ol:function(){return i},SZ:function(){return u},Zb:function(){return c},aY:function(){return d},eW:function(){return l},ll:function(){return o}});var n=r(7821),a=r(8078),s=r(5659);let c=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("div",{ref:t,className:(0,s.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",r),...a})});c.displayName="Card";let i=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("div",{ref:t,className:(0,s.cn)("flex flex-col space-y-1.5 p-6",r),...a})});i.displayName="CardHeader";let o=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("h3",{ref:t,className:(0,s.cn)("text-2xl font-semibold leading-none tracking-tight",r),...a})});o.displayName="CardTitle";let u=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("p",{ref:t,className:(0,s.cn)("text-sm text-muted-foreground",r),...a})});u.displayName="CardDescription";let d=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("div",{ref:t,className:(0,s.cn)("p-6 pt-0",r),...a})});d.displayName="CardContent";let l=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("div",{ref:t,className:(0,s.cn)("flex items-center p-6 pt-0",r),...a})});l.displayName="CardFooter"},9827:function(e,t,r){"use strict";r.d(t,{I:function(){return c}});var n=r(7821),a=r(8078),s=r(5659);let c=a.forwardRef((e,t)=>{let{className:r,type:a,...c}=e;return(0,n.jsx)("input",{type:a,className:(0,s.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",r),ref:t,...c})});c.displayName="Input"},8407:function(e,t,r){"use strict";r.d(t,{_:function(){return u}});var n=r(7821),a=r(8078),s=r(5895),c=r(2555),i=r(5659);let o=(0,c.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),u=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)(s.f,{ref:t,className:(0,i.cn)(o(),r),...a})});u.displayName=s.f.displayName},385:function(e,t,r){"use strict";r.d(t,{KQ:function(){return s},hi:function(){return d}});var n=r(758);let a="http://192.168.0.8:4000/api",s="cart_id";class c extends Error{constructor(e,t,r){super(t),this.status=e,this.errors=r,this.name="ApiError"}}async function i(e){let t=await e.json();if(!e.ok)throw new c(e.status,t.message||"An error occurred",t.errors);return t}function o(){return n.Z.get(s)}function u(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0],t={"Content-Type":"application/json"};if(e){let e=o();e&&(t["X-Cart-Id"]=e)}return t}let d={async getProducts(e){let t=new URLSearchParams;return e&&Object.entries(e).forEach(e=>{let[r,n]=e;void 0!==n&&t.append(r,String(n))}),i(await fetch("".concat(a,"/products?").concat(t.toString()),{headers:u(!1)}))},getProduct:async e=>i(await fetch("".concat(a,"/products/").concat(e),{headers:u(!1)})),getFeaturedProducts:async()=>i(await fetch("".concat(a,"/products/featured"),{headers:u(!1)})),getCategories:async()=>i(await fetch("".concat(a,"/categories"),{headers:u(!1)})),getCategoryTree:async()=>i(await fetch("".concat(a,"/categories/tree"),{headers:u(!1)})),async createCart(){var e,t;let r=await fetch("".concat(a,"/cart"),{method:"POST",headers:u(!1)}),c=await i(r);return(null===(e=c.data)||void 0===e?void 0:e.cartId)&&(t=c.data.cartId,n.Z.set(s,t,{expires:365})),c},async getCart(){let e=o();if(!e)return{success:!0,data:{items:[],subtotal:0,itemCount:0}};try{let t=await fetch("".concat(a,"/cart/").concat(e),{headers:u()});return await i(t)}catch(e){if(e instanceof c&&404===e.status)return n.Z.remove(s),{success:!0,data:{items:[],subtotal:0,itemCount:0}};throw e}},async addToCart(e){var t,r;let d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,l=o();l||(l=null===(t=(await this.createCart()).data)||void 0===t?void 0:t.cartId);try{let t=await fetch("".concat(a,"/cart/").concat(l,"/items"),{method:"POST",headers:u(),body:JSON.stringify({productId:e,quantity:d})});return await i(t)}catch(t){if(t instanceof c&&404===t.status)return n.Z.remove(s),l=null===(r=(await this.createCart()).data)||void 0===r?void 0:r.cartId,i(await fetch("".concat(a,"/cart/").concat(l,"/items"),{method:"POST",headers:u(),body:JSON.stringify({productId:e,quantity:d})}));throw t}},async updateCartItem(e,t){let r=o();if(!r)throw new c(400,"No cart found");return i(await fetch("".concat(a,"/cart/").concat(r,"/items/").concat(e),{method:"PUT",headers:u(),body:JSON.stringify({quantity:t})}))},async removeFromCart(e){let t=o();if(!t)throw new c(400,"No cart found");return i(await fetch("".concat(a,"/cart/").concat(t,"/items/").concat(e),{method:"DELETE",headers:u()}))},async clearCart(){let e=o();return e?i(await fetch("".concat(a,"/cart/").concat(e,"/items"),{method:"DELETE",headers:u()})):{success:!0,data:null}},async checkout(e){let t=await fetch("".concat(a,"/orders/checkout"),{method:"POST",headers:u(),body:JSON.stringify(e)}),r=await i(t);return r.success&&n.Z.remove(s),r},trackOrder:async e=>i(await fetch("".concat(a,"/orders/track/").concat(e),{headers:u(!1)})),initiatePayment:async(e,t)=>i(await fetch("".concat(a,"/payments/initiate"),{method:"POST",headers:u(!1),body:JSON.stringify({orderId:e,phoneNumber:t})})),checkPaymentStatus:async e=>i(await fetch("".concat(a,"/payments/").concat(e,"/status"),{headers:u(!1)}))};t.ZP=d},5659:function(e,t,r){"use strict";r.d(t,{Dx:function(){return o},Jn:function(){return i},T4:function(){return c},cn:function(){return s},ew:function(){return u}});var n=r(6252),a=r(3973);function s(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,a.m6)((0,n.W)(t))}function c(e){return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"XAF",r=Math.round(e).toLocaleString("fr-FR"),n={XAF:"FCFA",USD:"$",EUR:"â‚¬",GBP:"\xa3"}[t]||t;return"XAF"===t?"".concat(r," ").concat(n):"".concat(n).concat(r)}("string"==typeof e?parseFloat(e):e,"XAF")}function i(e){var t,r,n;let a=null===(t=e.images)||void 0===t?void 0:t.find(e=>e.isPrimary);return(null==a?void 0:a.url)||(null===(n=e.images)||void 0===n?void 0:null===(r=n[0])||void 0===r?void 0:r.url)||"/placeholder-product.png"}function o(e){switch(e){case"PAID":return"bg-green-100 text-green-800";case"PENDING":return"bg-yellow-100 text-yellow-800";case"FAILED":return"bg-red-100 text-red-800";case"REFUNDED":return"bg-purple-100 text-purple-800";default:return"bg-gray-100 text-gray-800"}}function u(e){return({PENDING:"Order Placed",PICKED_UP:"Picked Up",IN_TRANSIT:"In Transit",DELIVERED:"Delivered",CANCELLED:"Cancelled"})[e]||e}},316:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,r(2210).Z)("CircleCheckBig",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},499:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,r(2210).Z)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},979:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,r(2210).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},5002:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,r(2210).Z)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},9829:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,r(2210).Z)("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]])},6665:function(e,t,r){"use strict";var n=r(319);r.o(n,"useParams")&&r.d(t,{useParams:function(){return n.useParams}}),r.o(n,"usePathname")&&r.d(t,{usePathname:function(){return n.usePathname}}),r.o(n,"useRouter")&&r.d(t,{useRouter:function(){return n.useRouter}}),r.o(n,"useSearchParams")&&r.d(t,{useSearchParams:function(){return n.useSearchParams}})},5895:function(e,t,r){"use strict";r.d(t,{f:function(){return o}});var n=r(8078);r(457);var a=r(7779),s=r(7821),c=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,t)=>{let r=(0,a.Z8)(`Primitive.${t}`),c=n.forwardRef((e,n)=>{let{asChild:a,...c}=e,i=a?r:t;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,s.jsx)(i,{...c,ref:n})});return c.displayName=`Primitive.${t}`,{...e,[t]:c}},{}),i=n.forwardRef((e,t)=>(0,s.jsx)(c.label,{...e,ref:t,onMouseDown:t=>{var r;t.target.closest("button, input, select, textarea")||(null===(r=e.onMouseDown)||void 0===r||r.call(e,t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));i.displayName="Label";var o=i},758:function(e,t,r){"use strict";/*! js-cookie v3.0.5 | MIT */function n(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)e[n]=r[n]}return e}r.d(t,{Z:function(){return a}});var a=function e(t,r){function a(e,a,s){if("undefined"!=typeof document){"number"==typeof(s=n({},r,s)).expires&&(s.expires=new Date(Date.now()+864e5*s.expires)),s.expires&&(s.expires=s.expires.toUTCString()),e=encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var c="";for(var i in s)s[i]&&(c+="; "+i,!0!==s[i]&&(c+="="+s[i].split(";")[0]));return document.cookie=e+"="+t.write(a,e)+c}}return Object.create({set:a,get:function(e){if("undefined"!=typeof document&&(!arguments.length||e)){for(var r=document.cookie?document.cookie.split("; "):[],n={},a=0;a<r.length;a++){var s=r[a].split("="),c=s.slice(1).join("=");try{var i=decodeURIComponent(s[0]);if(n[i]=t.read(c,i),e===i)break}catch(e){}}return e?n[e]:n}},remove:function(e,t){a(e,"",n({},t,{expires:-1}))},withAttributes:function(t){return e(this.converter,n({},this.attributes,t))},withConverter:function(t){return e(n({},this.converter,t),this.attributes)}},{attributes:{value:Object.freeze(r)},converter:{value:Object.freeze(t)}})}({read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"})}},function(e){e.O(0,[8616,7115,9069,1744],function(){return e(e.s=732)}),_N_E=e.O()}]);