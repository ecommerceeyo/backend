(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7648],{7592:function(e,s,t){Promise.resolve().then(t.bind(t,9987))},9987:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return f}});var r=t(7821),a=t(8078),i=t(6665),c=t(5002),l=t(4601),o=t(346),n=t(3572),d=t(9827),p=t(8407),u=t(5445),m=t(5537),h=t(3481),x=t(8770),g=t(7251),v=t(7944),j=t(8153),y=t(7384);function f(){let e=(0,i.useRouter)(),s=(0,i.useParams)().id,[t,f]=(0,a.useState)(!0),[N,P]=(0,a.useState)(!1),[S,b]=(0,a.useState)([]),[k,I]=(0,a.useState)([]),[C,O]=(0,a.useState)([]),[w,F]=(0,a.useState)([]),[A,Z]=(0,a.useState)({name:"",description:"",price:"",compareAtPrice:"",stock:"",sku:"",categoryId:"",isActive:!0,isPreorder:!1,preorderNote:""}),[_,D]=(0,a.useState)({});(0,a.useEffect)(()=>{(async()=>{try{let[l,o]=await Promise.all([y.R.getProduct(s),y.R.getCategories()]);if(l.success&&l.data){var e,t,r,a,i,c;let s=l.data;Z({name:s.name,description:s.description||"",price:s.price.toString(),compareAtPrice:(null===(e=s.comparePrice)||void 0===e?void 0:e.toString())||"",stock:s.stock.toString(),sku:s.sku||"",categoryId:(null===(r=s.categories)||void 0===r?void 0:null===(t=r[0])||void 0===t?void 0:t.categoryId)||(null===(c=s.categories)||void 0===c?void 0:null===(i=c[0])||void 0===i?void 0:null===(a=i.category)||void 0===a?void 0:a.id)||"",isActive:s.active,isPreorder:s.isPreorder||!1,preorderNote:s.preorderNote||""}),s.images&&I(s.images.map(e=>({url:e.url,publicId:e.publicId,isPrimary:e.isPrimary}))),s.specifications&&O(s.specifications.map(e=>({key:e.key,value:e.value,group:e.group||void 0}))),s.deliveryZones&&F(s.deliveryZones.map(e=>{var s,t,r,a;return{zoneName:e.zoneName,zoneType:e.zoneType||"city",region:null!==(s=e.region)&&void 0!==s?s:void 0,minDays:e.minDays,maxDays:e.maxDays,deliveryFee:null!==(t=e.deliveryFee)&&void 0!==t?t:void 0,available:null===(r=e.available)||void 0===r||r,notes:null!==(a=e.notes)&&void 0!==a?a:void 0}}))}o.success&&o.data&&b(o.data)}catch(e){console.error("Failed to fetch data:",e),D({submit:"Failed to load product data"})}finally{f(!1)}})()},[s]);let T=()=>{let e={};return A.name.trim()||(e.name="Name is required"),(!A.price||0>=parseFloat(A.price))&&(e.price="Valid price is required"),(!A.stock||0>parseInt(A.stock))&&(e.stock="Valid stock quantity is required"),A.categoryId||(e.categoryId="Category is required"),D(e),0===Object.keys(e).length},z=async t=>{if(t.preventDefault(),T()){P(!0);try{let t={name:A.name,description:A.description,price:parseFloat(A.price),compareAtPrice:A.compareAtPrice?parseFloat(A.compareAtPrice):void 0,stock:parseInt(A.stock),sku:A.sku||void 0,categoryId:A.categoryId,isActive:A.isActive,isPreorder:A.isPreorder,preorderNote:A.preorderNote||void 0,images:k.map(e=>({url:e.url,publicId:e.publicId,isPrimary:e.isPrimary})),specifications:C.filter(e=>""!==e.value.trim()).map(e=>({key:e.key,value:e.value,group:e.group})),deliveryZones:w.filter(e=>""!==e.zoneName.trim()).map(e=>({zoneName:e.zoneName,zoneType:e.zoneType,region:e.region,minDays:e.minDays,maxDays:e.maxDays,deliveryFee:e.deliveryFee,available:e.available,notes:e.notes}))},r=await y.R.updateProduct(s,t);r.success?e.push("/supplier/products"):D({submit:r.error||"Failed to update product"})}catch(e){D({submit:e.message||"An error occurred. Please try again."})}finally{P(!1)}}};return t?(0,r.jsx)("div",{className:"flex h-[50vh] items-center justify-center",children:(0,r.jsx)(c.Z,{className:"h-8 w-8 animate-spin"})}):(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsxs)(o.default,{href:"/supplier/products",className:"mb-6 inline-flex items-center text-sm text-muted-foreground hover:text-foreground",children:[(0,r.jsx)(l.Z,{className:"mr-2 h-4 w-4"}),"Back to Products"]}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold",children:"Edit Product"}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"Update your product information"})]}),(0,r.jsxs)("form",{onSubmit:z,className:"space-y-6",children:[_.submit&&(0,r.jsx)("div",{className:"rounded-lg bg-destructive/10 p-4 text-sm text-destructive",children:_.submit}),(0,r.jsxs)("div",{className:"grid gap-6 lg:grid-cols-3",children:[(0,r.jsxs)("div",{className:"space-y-6 lg:col-span-2",children:[(0,r.jsxs)(m.Zb,{children:[(0,r.jsx)(m.Ol,{children:(0,r.jsx)(m.ll,{children:"Product Information"})}),(0,r.jsxs)(m.aY,{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)(p._,{htmlFor:"name",children:["Name ",(0,r.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,r.jsx)(d.I,{id:"name",value:A.name,onChange:e=>Z({...A,name:e.target.value}),placeholder:"Product name"}),_.name&&(0,r.jsx)("p",{className:"text-sm text-destructive",children:_.name})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(p._,{htmlFor:"description",children:"Description"}),(0,r.jsx)(u.g,{id:"description",value:A.description,onChange:e=>Z({...A,description:e.target.value}),placeholder:"Product description",rows:5})]})]})]}),(0,r.jsxs)(m.Zb,{children:[(0,r.jsx)(m.Ol,{children:(0,r.jsx)(m.ll,{children:"Media"})}),(0,r.jsx)(m.aY,{children:(0,r.jsx)(g.U,{images:k,onImagesChange:I,maxImages:6})})]}),(0,r.jsxs)(m.Zb,{children:[(0,r.jsx)(m.Ol,{children:(0,r.jsx)(m.ll,{children:"Pricing"})}),(0,r.jsx)(m.aY,{className:"space-y-4",children:(0,r.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)(p._,{htmlFor:"price",children:["Price (FCFA) ",(0,r.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,r.jsx)(d.I,{id:"price",type:"number",step:"1",min:"0",value:A.price,onChange:e=>Z({...A,price:e.target.value}),placeholder:"0"}),_.price&&(0,r.jsx)("p",{className:"text-sm text-destructive",children:_.price})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(p._,{htmlFor:"compareAtPrice",children:"Compare at Price"}),(0,r.jsx)(d.I,{id:"compareAtPrice",type:"number",step:"1",min:"0",value:A.compareAtPrice,onChange:e=>Z({...A,compareAtPrice:e.target.value}),placeholder:"0"})]})]})})]}),(0,r.jsxs)(m.Zb,{children:[(0,r.jsx)(m.Ol,{children:(0,r.jsx)(m.ll,{children:"Inventory"})}),(0,r.jsx)(m.aY,{className:"space-y-4",children:(0,r.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)(p._,{htmlFor:"stock",children:["Stock ",(0,r.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,r.jsx)(d.I,{id:"stock",type:"number",min:"0",value:A.stock,onChange:e=>Z({...A,stock:e.target.value}),placeholder:"0"}),_.stock&&(0,r.jsx)("p",{className:"text-sm text-destructive",children:_.stock})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(p._,{htmlFor:"sku",children:"SKU"}),(0,r.jsx)(d.I,{id:"sku",value:A.sku,onChange:e=>Z({...A,sku:e.target.value}),placeholder:"SKU-001"})]})]})})]}),(0,r.jsxs)(m.Zb,{children:[(0,r.jsx)(m.Ol,{children:(0,r.jsx)(m.ll,{children:"Specifications"})}),(0,r.jsx)(m.aY,{children:(0,r.jsx)(v.l,{specifications:C,onChange:O})})]}),(0,r.jsxs)(m.Zb,{children:[(0,r.jsx)(m.Ol,{children:(0,r.jsx)(m.ll,{children:"Delivery Zones & Periods"})}),(0,r.jsx)(m.aY,{children:(0,r.jsx)(j.J,{deliveryZones:w,onChange:F})})]})]}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)(m.Zb,{children:[(0,r.jsx)(m.Ol,{children:(0,r.jsx)(m.ll,{children:"Organization"})}),(0,r.jsx)(m.aY,{className:"space-y-4",children:(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)(p._,{children:["Category ",(0,r.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,r.jsxs)(h.Ph,{value:A.categoryId,onValueChange:e=>Z({...A,categoryId:e}),children:[(0,r.jsx)(h.i4,{children:(0,r.jsx)(h.ki,{placeholder:"Select category"})}),(0,r.jsx)(h.Bw,{children:S.map(e=>(0,r.jsx)(h.Ql,{value:e.id,children:e.name},e.id))})]}),_.categoryId&&(0,r.jsx)("p",{className:"text-sm text-destructive",children:_.categoryId})]})})]}),(0,r.jsxs)(m.Zb,{children:[(0,r.jsx)(m.Ol,{children:(0,r.jsx)(m.ll,{children:"Status"})}),(0,r.jsxs)(m.aY,{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)(p._,{htmlFor:"isActive",children:"Active"}),(0,r.jsx)(x.r,{id:"isActive",checked:A.isActive,onCheckedChange:e=>Z({...A,isActive:e})})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)(p._,{htmlFor:"isPreorder",children:"Pre-order"}),(0,r.jsx)(x.r,{id:"isPreorder",checked:A.isPreorder,onCheckedChange:e=>Z({...A,isPreorder:e})})]}),A.isPreorder&&(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(p._,{htmlFor:"preorderNote",children:"Pre-order Note"}),(0,r.jsx)(d.I,{id:"preorderNote",value:A.preorderNote,onChange:e=>Z({...A,preorderNote:e.target.value}),placeholder:"e.g., Ships in 2-3 weeks"}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"Shown to customers when they order this product"})]})]})]})]})]}),(0,r.jsxs)("div",{className:"flex justify-end gap-4",children:[(0,r.jsx)(o.default,{href:"/supplier/products",children:(0,r.jsx)(n.z,{type:"button",variant:"outline",children:"Cancel"})}),(0,r.jsx)(n.z,{type:"submit",disabled:N,children:N?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(c.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Saving..."]}):"Save Changes"})]})]})]})}},7384:function(e,s,t){"use strict";t.d(s,{R:function(){return c}});let r="http://192.168.0.8:4000/api";function a(){let e=localStorage.getItem("supplier-auth");if(!e)return{};try{let{state:s}=JSON.parse(e);if(null==s?void 0:s.token)return{Authorization:"Bearer ".concat(s.token)}}catch(e){}return{}}async function i(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=await fetch(e,{...s,headers:{"Content-Type":"application/json",...a(),...s.headers}}),r=await t.json();if(!t.ok)throw Error(r.error||"Request failed");return r}let c={getDashboard:()=>i("".concat(r,"/supplier-portal/dashboard")),getProfile:()=>i("".concat(r,"/supplier-portal/profile")),updateProfile:e=>i("".concat(r,"/supplier-portal/profile"),{method:"PUT",body:JSON.stringify(e)}),getProducts:e=>{let s=new URLSearchParams;return(null==e?void 0:e.page)&&s.set("page",e.page.toString()),(null==e?void 0:e.limit)&&s.set("limit",e.limit.toString()),(null==e?void 0:e.search)&&s.set("search",e.search),(null==e?void 0:e.active)!==void 0&&s.set("active",e.active.toString()),i("".concat(r,"/supplier-portal/products?").concat(s))},getProduct:e=>i("".concat(r,"/supplier-portal/products/").concat(e)),createProduct:e=>i("".concat(r,"/supplier-portal/products"),{method:"POST",body:JSON.stringify(e)}),updateProduct:(e,s)=>i("".concat(r,"/supplier-portal/products/").concat(e),{method:"PUT",body:JSON.stringify(s)}),deleteProduct:e=>i("".concat(r,"/supplier-portal/products/").concat(e),{method:"DELETE"}),getOrders:e=>{let s=new URLSearchParams;return(null==e?void 0:e.page)&&s.set("page",e.page.toString()),(null==e?void 0:e.limit)&&s.set("limit",e.limit.toString()),(null==e?void 0:e.status)&&s.set("status",e.status),(null==e?void 0:e.search)&&s.set("search",e.search),i("".concat(r,"/supplier-portal/orders?").concat(s))},getOrderItem:e=>i("".concat(r,"/supplier-portal/orders/").concat(e)),updateFulfillment:(e,s)=>i("".concat(r,"/supplier-portal/orders/").concat(e,"/fulfillment"),{method:"PATCH",body:JSON.stringify(s)}),getPayouts:e=>{let s=new URLSearchParams;return(null==e?void 0:e.page)&&s.set("page",e.page.toString()),(null==e?void 0:e.limit)&&s.set("limit",e.limit.toString()),i("".concat(r,"/supplier-portal/payouts?").concat(s))},getStaff:()=>i("".concat(r,"/supplier-auth/staff")),createStaff:e=>i("".concat(r,"/supplier-auth/staff"),{method:"POST",body:JSON.stringify(e)}),updateStaffStatus:(e,s)=>i("".concat(r,"/supplier-auth/staff/").concat(e,"/status"),{method:"PATCH",body:JSON.stringify({active:s})}),deleteStaff:e=>i("".concat(r,"/supplier-auth/staff/").concat(e),{method:"DELETE"}),changePassword:(e,s)=>i("".concat(r,"/supplier-auth/change-password"),{method:"POST",body:JSON.stringify({currentPassword:e,newPassword:s})}),getCategories:()=>fetch("".concat(r,"/categories")).then(e=>e.json()),uploadImage:async e=>{let s=new FormData;return s.append("image",e),(await fetch("".concat(r,"/admin/upload/image"),{method:"POST",headers:a(),body:s})).json()}}}},function(e){e.O(0,[8616,7886,346,9216,807,3444,8088,3929,9632,7115,9069,1744],function(){return e(e.s=7592)}),_N_E=e.O()}]);