(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[692],{9599:function(e,s,r){Promise.resolve().then(r.bind(r,9345))},9345:function(e,s,r){"use strict";r.r(s),r.d(s,{default:function(){return N}});var t=r(7821),a=r(8078),i=r(6665),l=r(5002),d=r(4601),n=r(346),c=r(3572),o=r(9827),u=r(8407),m=r(5445),p=r(5537),x=r(3481),h=r(8770),j=r(2098),f=r(7251),v=r(7944),g=r(8153),y=r(6622);function N(){var e,s;let r=(0,i.useRouter)(),N=(0,i.useParams)().id,[b,k]=(0,a.useState)(!0),[w,P]=(0,a.useState)(!1),[I,C]=(0,a.useState)([]),[F,S]=(0,a.useState)([]),[Z,A]=(0,a.useState)([]),[_,z]=(0,a.useState)([]),[O,D]=(0,a.useState)([]),[q,R]=(0,a.useState)(null),[E,V]=(0,a.useState)({name:"",description:"",price:"",compareAtPrice:"",stock:"",sku:"",categoryId:"",supplierId:"",isActive:!0,isFeatured:!1,isPreorder:!1,preorderNote:""}),[Y,U]=(0,a.useState)({});(0,a.useEffect)(()=>{(async()=>{try{let[l,d,n]=await Promise.all([y.Nq.getProduct(N),y.Nq.getCategories(),y.Nq.getSuppliers({status:"ACTIVE",limit:100})]);if(l.success&&l.data){var e,s,r,t,a,i;let d=l.data;V({name:d.name,description:d.description||"",price:d.price.toString(),compareAtPrice:(null===(e=d.comparePrice)||void 0===e?void 0:e.toString())||"",stock:d.stock.toString(),sku:d.sku||"",categoryId:(null===(r=d.categories)||void 0===r?void 0:null===(s=r[0])||void 0===s?void 0:s.categoryId)||(null===(i=d.categories)||void 0===i?void 0:null===(a=i[0])||void 0===a?void 0:null===(t=a.category)||void 0===t?void 0:t.id)||"",supplierId:d.supplierId||"",isActive:d.active,isFeatured:d.featured,isPreorder:d.isPreorder||!1,preorderNote:d.preorderNote||""}),d.supplierId&&R(d.supplierId),d.images&&A(d.images.map(e=>({url:e.url,publicId:e.publicId,isPrimary:e.isPrimary}))),d.specifications&&z(d.specifications.map(e=>({key:e.key,value:e.value,group:e.group||void 0}))),d.deliveryZones&&D(d.deliveryZones.map(e=>{var s,r,t,a;return{zoneName:e.zoneName,zoneType:e.zoneType||"city",region:null!==(s=e.region)&&void 0!==s?s:void 0,minDays:e.minDays,maxDays:e.maxDays,deliveryFee:null!==(r=e.deliveryFee)&&void 0!==r?r:void 0,available:null===(t=e.available)||void 0===t||t,notes:null!==(a=e.notes)&&void 0!==a?a:void 0}}))}if(d.success&&d.data&&C(d.data),n.success&&n.data){let e=n.data,s=Array.isArray(e)?e:e.items||[];S(s)}}catch(e){console.error("Failed to fetch data:",e)}finally{k(!1)}})()},[N]);let T=()=>{let e={};return E.name.trim()||(e.name="Name is required"),(!E.price||0>=parseFloat(E.price))&&(e.price="Valid price is required"),(!E.stock||0>parseInt(E.stock))&&(e.stock="Valid stock quantity is required"),E.categoryId||(e.categoryId="Category is required"),U(e),0===Object.keys(e).length},B=async e=>{if(e.preventDefault(),T()){P(!0);try{let e={name:E.name,description:E.description,price:parseFloat(E.price),compareAtPrice:E.compareAtPrice?parseFloat(E.compareAtPrice):void 0,stock:parseInt(E.stock),sku:E.sku||void 0,categoryId:E.categoryId,supplierId:E.supplierId||void 0,isActive:E.isActive,isFeatured:E.isFeatured,isPreorder:E.isPreorder,preorderNote:E.preorderNote||void 0,images:Z.map(e=>({url:e.url,publicId:e.publicId,isPrimary:e.isPrimary})),specifications:_.filter(e=>""!==e.value.trim()).map(e=>({key:e.key,value:e.value,group:e.group})),deliveryZones:O.filter(e=>""!==e.zoneName.trim()).map(e=>({zoneName:e.zoneName,zoneType:e.zoneType,region:e.region,minDays:e.minDays,maxDays:e.maxDays,deliveryFee:e.deliveryFee,available:e.available,notes:e.notes}))},s=await y.Nq.updateProduct(N,e);s.success?r.push("/admin/products"):U({submit:s.error||"Failed to update product"})}catch(e){U({submit:"An error occurred. Please try again."})}finally{P(!1)}}};return b?(0,t.jsx)("div",{className:"flex h-screen items-center justify-center",children:(0,t.jsx)(l.Z,{className:"h-8 w-8 animate-spin"})}):(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)(j.P,{title:"Edit Product"}),(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsxs)(n.default,{href:"/admin/products",className:"mb-6 inline-flex items-center text-sm text-muted-foreground hover:text-foreground",children:[(0,t.jsx)(d.Z,{className:"mr-2 h-4 w-4"}),"Back to Products"]}),(0,t.jsxs)("form",{onSubmit:B,className:"space-y-6",children:[Y.submit&&(0,t.jsx)("div",{className:"rounded-lg bg-destructive/10 p-4 text-sm text-destructive",children:Y.submit}),(0,t.jsxs)("div",{className:"grid gap-6 lg:grid-cols-3",children:[(0,t.jsxs)("div",{className:"space-y-6 lg:col-span-2",children:[(0,t.jsxs)(p.Zb,{children:[(0,t.jsx)(p.Ol,{children:(0,t.jsx)(p.ll,{children:"Product Information"})}),(0,t.jsxs)(p.aY,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(u._,{htmlFor:"name",children:["Name ",(0,t.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,t.jsx)(o.I,{id:"name",value:E.name,onChange:e=>V({...E,name:e.target.value}),placeholder:"Product name"}),Y.name&&(0,t.jsx)("p",{className:"text-sm text-destructive",children:Y.name})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(u._,{htmlFor:"description",children:"Description"}),(0,t.jsx)(m.g,{id:"description",value:E.description,onChange:e=>V({...E,description:e.target.value}),placeholder:"Product description",rows:5})]})]})]}),(0,t.jsxs)(p.Zb,{children:[(0,t.jsx)(p.Ol,{children:(0,t.jsx)(p.ll,{children:"Media"})}),(0,t.jsx)(p.aY,{children:(0,t.jsx)(f.U,{images:Z,onImagesChange:A,maxImages:6})})]}),(0,t.jsxs)(p.Zb,{children:[(0,t.jsx)(p.Ol,{children:(0,t.jsx)(p.ll,{children:"Pricing"})}),(0,t.jsx)(p.aY,{className:"space-y-4",children:(0,t.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(u._,{htmlFor:"price",children:["Price (GHS) ",(0,t.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,t.jsx)(o.I,{id:"price",type:"number",step:"0.01",min:"0",value:E.price,onChange:e=>V({...E,price:e.target.value}),placeholder:"0.00"}),Y.price&&(0,t.jsx)("p",{className:"text-sm text-destructive",children:Y.price})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(u._,{htmlFor:"compareAtPrice",children:"Compare at Price"}),(0,t.jsx)(o.I,{id:"compareAtPrice",type:"number",step:"0.01",min:"0",value:E.compareAtPrice,onChange:e=>V({...E,compareAtPrice:e.target.value}),placeholder:"0.00"})]})]})})]}),(0,t.jsxs)(p.Zb,{children:[(0,t.jsx)(p.Ol,{children:(0,t.jsx)(p.ll,{children:"Inventory"})}),(0,t.jsx)(p.aY,{className:"space-y-4",children:(0,t.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(u._,{htmlFor:"stock",children:["Stock ",(0,t.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,t.jsx)(o.I,{id:"stock",type:"number",min:"0",value:E.stock,onChange:e=>V({...E,stock:e.target.value}),placeholder:"0"}),Y.stock&&(0,t.jsx)("p",{className:"text-sm text-destructive",children:Y.stock})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(u._,{htmlFor:"sku",children:"SKU"}),(0,t.jsx)(o.I,{id:"sku",value:E.sku,onChange:e=>V({...E,sku:e.target.value}),placeholder:"SKU-001"})]})]})})]}),(0,t.jsxs)(p.Zb,{children:[(0,t.jsx)(p.Ol,{children:(0,t.jsx)(p.ll,{children:"Specifications"})}),(0,t.jsx)(p.aY,{children:(0,t.jsx)(v.l,{specifications:_,onChange:z})})]}),(0,t.jsxs)(p.Zb,{children:[(0,t.jsx)(p.Ol,{children:(0,t.jsx)(p.ll,{children:"Delivery Zones & Periods"})}),(0,t.jsx)(p.aY,{children:(0,t.jsx)(g.J,{deliveryZones:O,onChange:D})})]})]}),(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)(p.Zb,{children:[(0,t.jsx)(p.Ol,{children:(0,t.jsx)(p.ll,{children:"Organization"})}),(0,t.jsxs)(p.aY,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(u._,{children:["Category ",(0,t.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,t.jsxs)(x.Ph,{value:E.categoryId,onValueChange:e=>V({...E,categoryId:e}),children:[(0,t.jsx)(x.i4,{children:(0,t.jsx)(x.ki,{placeholder:"Select category"})}),(0,t.jsx)(x.Bw,{children:I.map(e=>(0,t.jsx)(x.Ql,{value:e.id,children:e.name},e.id))})]}),Y.categoryId&&(0,t.jsx)("p",{className:"text-sm text-destructive",children:Y.categoryId})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(u._,{children:"Supplier"}),q?(0,t.jsx)("div",{className:"rounded-md border border-input bg-muted px-3 py-2 text-sm",children:(null===(e=F.find(e=>e.id===q))||void 0===e?void 0:e.businessName)||(null===(s=F.find(e=>e.id===q))||void 0===s?void 0:s.name)||"Loading supplier..."}):(0,t.jsxs)(x.Ph,{value:E.supplierId||"NONE",onValueChange:e=>V({...E,supplierId:"NONE"===e?"":e}),children:[(0,t.jsx)(x.i4,{children:(0,t.jsx)(x.ki,{placeholder:"Select supplier (optional)"})}),(0,t.jsxs)(x.Bw,{children:[(0,t.jsx)(x.Ql,{value:"NONE",children:"No supplier (Platform owned)"}),F.map(e=>(0,t.jsx)(x.Ql,{value:e.id,children:e.businessName||e.name},e.id))]})]}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:q?"Supplier cannot be changed for supplier-owned products":"Assign this product to a supplier for multi-vendor support"})]})]})]}),(0,t.jsxs)(p.Zb,{children:[(0,t.jsx)(p.Ol,{children:(0,t.jsx)(p.ll,{children:"Status"})}),(0,t.jsxs)(p.aY,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)(u._,{htmlFor:"isActive",children:"Active"}),(0,t.jsx)(h.r,{id:"isActive",checked:E.isActive,onCheckedChange:e=>V({...E,isActive:e})})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)(u._,{htmlFor:"isFeatured",children:"Featured"}),(0,t.jsx)(h.r,{id:"isFeatured",checked:E.isFeatured,onCheckedChange:e=>V({...E,isFeatured:e})})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)(u._,{htmlFor:"isPreorder",children:"Pre-order"}),(0,t.jsx)(h.r,{id:"isPreorder",checked:E.isPreorder,onCheckedChange:e=>V({...E,isPreorder:e})})]}),E.isPreorder&&(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(u._,{htmlFor:"preorderNote",children:"Pre-order Note"}),(0,t.jsx)(o.I,{id:"preorderNote",value:E.preorderNote,onChange:e=>V({...E,preorderNote:e.target.value}),placeholder:"e.g., Ships in 2-3 weeks"}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Shown to customers when they order this product"})]})]})]})]})]}),(0,t.jsxs)("div",{className:"flex justify-end gap-4",children:[(0,t.jsx)(n.default,{href:"/admin/products",children:(0,t.jsx)(c.z,{type:"button",variant:"outline",children:"Cancel"})}),(0,t.jsx)(c.z,{type:"submit",disabled:w,children:w?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(l.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Saving..."]}):"Save Changes"})]})]})]})]})}},2098:function(e,s,r){"use strict";r.d(s,{P:function(){return m}});var t=r(7821),a=r(9388),i=r(1149),l=r(3263),d=r(3572),n=r(9827),c=r(1502),o=r(2285),u=r(6665);function m(e){let{title:s}=e,{admin:r,logout:m}=(0,o.t)(),p=(0,u.useRouter)();return(0,t.jsxs)("header",{className:"flex h-16 items-center justify-between border-b bg-card px-6",children:[(0,t.jsx)("div",{className:"flex items-center gap-4",children:s&&(0,t.jsx)("h1",{className:"text-xl font-semibold",children:s})}),(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsxs)("div",{className:"relative hidden md:block",children:[(0,t.jsx)(a.Z,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),(0,t.jsx)(n.I,{placeholder:"Search...",className:"w-64 pl-10"})]}),(0,t.jsxs)(d.z,{variant:"ghost",size:"icon",className:"relative",children:[(0,t.jsx)(i.Z,{className:"h-5 w-5"}),(0,t.jsx)("span",{className:"absolute right-1 top-1 h-2 w-2 rounded-full bg-destructive"})]}),(0,t.jsxs)(c.h_,{children:[(0,t.jsx)(c.$F,{asChild:!0,children:(0,t.jsx)(d.z,{variant:"ghost",size:"icon",children:(0,t.jsx)(l.Z,{className:"h-5 w-5"})})}),(0,t.jsxs)(c.AW,{align:"end",className:"w-56",children:[(0,t.jsx)(c.Ju,{children:(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium",children:null==r?void 0:r.name}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:null==r?void 0:r.email})]})}),(0,t.jsx)(c.VD,{}),(0,t.jsx)(c.Xi,{onClick:()=>p.push("/admin/settings"),children:"Settings"}),(0,t.jsx)(c.VD,{}),(0,t.jsx)(c.Xi,{onClick:()=>{m(),p.push("/admin/login")},className:"text-destructive",children:"Logout"})]})]})]})]})}},1502:function(e,s,r){"use strict";r.d(s,{$F:function(){return u},AW:function(){return m},Ju:function(){return x},VD:function(){return h},Xi:function(){return p},h_:function(){return o}});var t=r(7821),a=r(8078),i=r(6182),l=r(2547),d=r(3402),n=r(2872),c=r(5659);let o=i.fC,u=i.xz;i.ZA,i.Uv,i.Tr,i.Ee,a.forwardRef((e,s)=>{let{className:r,inset:a,children:d,...n}=e;return(0,t.jsxs)(i.fF,{ref:s,className:(0,c.cn)("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",a&&"pl-8",r),...n,children:[d,(0,t.jsx)(l.Z,{className:"ml-auto h-4 w-4"})]})}).displayName=i.fF.displayName,a.forwardRef((e,s)=>{let{className:r,...a}=e;return(0,t.jsx)(i.tu,{ref:s,className:(0,c.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r),...a})}).displayName=i.tu.displayName;let m=a.forwardRef((e,s)=>{let{className:r,sideOffset:a=4,...l}=e;return(0,t.jsx)(i.Uv,{children:(0,t.jsx)(i.VY,{ref:s,sideOffset:a,className:(0,c.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r),...l})})});m.displayName=i.VY.displayName;let p=a.forwardRef((e,s)=>{let{className:r,inset:a,...l}=e;return(0,t.jsx)(i.ck,{ref:s,className:(0,c.cn)("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a&&"pl-8",r),...l})});p.displayName=i.ck.displayName,a.forwardRef((e,s)=>{let{className:r,children:a,checked:l,...n}=e;return(0,t.jsxs)(i.oC,{ref:s,className:(0,c.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r),checked:l,...n,children:[(0,t.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,t.jsx)(i.wU,{children:(0,t.jsx)(d.Z,{className:"h-4 w-4"})})}),a]})}).displayName=i.oC.displayName,a.forwardRef((e,s)=>{let{className:r,children:a,...l}=e;return(0,t.jsxs)(i.Rk,{ref:s,className:(0,c.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r),...l,children:[(0,t.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,t.jsx)(i.wU,{children:(0,t.jsx)(n.Z,{className:"h-2 w-2 fill-current"})})}),a]})}).displayName=i.Rk.displayName;let x=a.forwardRef((e,s)=>{let{className:r,inset:a,...l}=e;return(0,t.jsx)(i.__,{ref:s,className:(0,c.cn)("px-2 py-1.5 text-sm font-semibold",a&&"pl-8",r),...l})});x.displayName=i.__.displayName;let h=a.forwardRef((e,s)=>{let{className:r,...a}=e;return(0,t.jsx)(i.Z0,{ref:s,className:(0,c.cn)("-mx-1 my-1 h-px bg-muted",r),...a})});h.displayName=i.Z0.displayName},1149:function(e,s,r){"use strict";r.d(s,{Z:function(){return t}});/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let t=(0,r(2210).Z)("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]])},9388:function(e,s,r){"use strict";r.d(s,{Z:function(){return t}});/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let t=(0,r(2210).Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},3263:function(e,s,r){"use strict";r.d(s,{Z:function(){return t}});/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let t=(0,r(2210).Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])}},function(e){e.O(0,[8616,7886,346,9216,807,6637,3444,8088,3929,9632,7115,9069,1744],function(){return e(e.s=9599)}),_N_E=e.O()}]);